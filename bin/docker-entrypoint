#!/bin/bash -e

echo "Entrypoint starting (PROCESS_TYPE=${PROCESS_TYPE:-web})..."

# Run db:migrate (not db:prepare) â€” faster, and database already exists on Railway
if [ "${PROCESS_TYPE:-web}" = "web" ]; then
  echo "Running database migrations..."
  ./bin/rails db:migrate 2>&1 || echo "Migration failed or skipped"
  echo "Migrations complete."
fi

echo "Starting application..."
exec "${@}"
