<div class="bg-white shadow rounded-lg p-6 hover:shadow-md transition-shadow flex flex-col">
  <%= link_to aggregated_list_path(aggregated_list), class: "block flex-1" do %>
    <div class="flex justify-between items-start">
      <h3 class="text-lg font-heading font-medium text-gray-900"><%= aggregated_list.name %></h3>
      <% case aggregated_list.match_status %>
      <% when "matched" %>
        <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium bg-green-100 text-green-800">Matched</span>
      <% when "matching" %>
        <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium bg-blue-100 text-blue-800">Matching...</span>
      <% when "failed" %>
        <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium bg-red-100 text-red-800">Failed</span>
      <% else %>
        <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium bg-gray-100 text-gray-800">Pending</span>
      <% end %>
    </div>

    <% if aggregated_list.description.present? %>
      <p class="mt-1 text-sm text-gray-500"><%= aggregated_list.description %></p>
    <% end %>

    <div class="mt-3 flex flex-wrap gap-2">
      <% aggregated_list.supplier_lists.each do |sl| %>
        <span class="inline-flex items-center rounded-full bg-brand-navy/10 px-2.5 py-0.5 text-xs font-medium text-brand-navy">
          <%= sl.supplier.name %>
        </span>
      <% end %>
    </div>

    <div class="mt-4 grid grid-cols-3 gap-4 text-center text-sm">
      <div>
        <p class="font-semibold text-gray-900"><%= aggregated_list.total_match_count %></p>
        <p class="text-gray-500">Products</p>
      </div>
      <div>
        <p class="font-semibold text-green-600"><%= aggregated_list.matched_product_count %></p>
        <p class="text-gray-500">Matched</p>
      </div>
      <div>
        <p class="font-semibold text-amber-600"><%= aggregated_list.unmatched_count %></p>
        <p class="text-gray-500">Unmatched</p>
      </div>
    </div>
  <% end %>

  <div class="mt-4 pt-4 border-t border-gray-100">
    <% if aggregated_list.matched? %>
      <%= link_to order_builder_aggregated_list_path(aggregated_list),
          data: { turbo: false },
          class: "block w-full text-center rounded-md bg-brand-green px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-brand-green-dark transition-colors" do %>
        Create Order
      <% end %>
    <% else %>
      <%= link_to aggregated_list_path(aggregated_list),
          class: "block w-full text-center rounded-md bg-gray-200 px-4 py-2 text-sm font-semibold text-gray-600 shadow-sm hover:bg-gray-300 transition-colors" do %>
        View Matching
      <% end %>
    <% end %>
  </div>
</div>
