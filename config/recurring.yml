# Recurring jobs â€” only run in production (Railway worker)
# Solid Queue checks for an environment key first; if found, only those jobs run.

development: {}

test: {}

production:
  # Rotate through suppliers to import product catalogs (each supplier ~1x/hour)
  staggered_supplier_import:
    class: StaggeredSupplierImportJob
    queue: scraping
    schedule: "*/15 * * * *"
    description: "Staggered supplier product import every 15 minutes"

  # Deep category browsing for US Foods (finds products missed by quick imports)
  deep_catalog_import:
    class: DeepCatalogImportJob
    queue: scraping
    schedule: "0 2 * * *"
    description: "US Foods deep category browse daily at 2 AM"

  # Proactive session keepalive for all suppliers
  refresh_sessions:
    class: RefreshAllSessionsJob
    queue: default
    schedule: "0 */2 * * *"
    description: "Refresh supplier sessions every 2 hours"

  # Mark products as discontinued if missing from 3+ consecutive imports
  discontinue_stale_products:
    class: DiscontinueStaleProductsJob
    queue: low
    schedule: "0 3 * * *"
    description: "Discontinue stale products daily at 3 AM"

  # Sync all supplier lists/order guides daily at 4 AM
  sync_all_lists:
    class: SyncAllListsJob
    queue: scraping
    schedule: "0 4 * * *"
    description: "Sync supplier lists/order guides for all active credentials"

  # Expire old 2FA requests every 5 minutes
  expire_2fa_requests:
    class: Expire2faRequestsJob
    queue: low
    schedule: "*/5 * * * *"
    description: "Expire old 2FA requests every 5 minutes"
